2022-02-15 18:48:16,980 - root - INFO - Flag Values:
{
    "L1_flag": false,
    "batch_size": 256,
    "ckpt_path": "/export/data/RA_Work/LipingWang/joint-kg-recommender_fork/log/",
    "clipping_max_value": 5.0,
    "data_path": "/export/data/RA_Work/LipingWang/joint-kg-recommender_fork/datasets/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 70000,
    "embedding_size": 64,
    "eval_interval_steps": 14000,
    "eval_only_mode": false,
    "experiment_name": "ml1m-jtransup-1644922096",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 1e-05,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": null,
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/export/data/RA_Work/LipingWang/joint-kg-recommender_fork/log/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "jtransup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adagrad",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 1400000,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2022-02-15 18:48:19,355 - root - INFO - Totally 701669 train ratings, 103239,193631 eval ratings in files: /export/data/RA_Work/LipingWang/joint-kg-recommender_fork/datasets/ml1m/valid.dat;/export/data/RA_Work/LipingWang/joint-kg-recommender_fork/datasets/ml1m/test.dat!
2022-02-15 18:48:19,366 - root - INFO - successfully load 6040 users and 3260 items!
2022-02-15 18:48:21,886 - root - INFO - Totally 303935 train triples, 43419,86835 eval triples in files: /export/data/RA_Work/LipingWang/joint-kg-recommender_fork/datasets/ml1m/kg/valid.dat;/export/data/RA_Work/LipingWang/joint-kg-recommender_fork/datasets/ml1m/kg/test.dat!
2022-02-15 18:48:21,906 - root - INFO - successfully load 14708 entities and 20 relations!
2022-02-15 18:48:22,270 - root - INFO - Find 2934 aligned items and entities!
2022-02-15 18:48:22,271 - root - INFO - Building model.
2022-02-15 18:48:26,511 - root - INFO - Architecture: jTransUPModel(
  (user_embeddings): Embedding(6040, 64)
  (item_embeddings): Embedding(3260, 64)
  (pref_embeddings): Embedding(20, 64)
  (pref_norm_embeddings): Embedding(20, 64)
  (ent_embeddings): Embedding(14709, 64, padding_idx=14708)
  (rel_embeddings): Embedding(20, 64)
  (norm_embeddings): Embedding(20, 64)
)
2022-02-15 18:48:26,511 - root - INFO - Total params: 1541696.0
2022-02-15 18:48:26,512 - root - INFO - One epoch is 5482 steps.
2022-02-15 18:48:26,513 - root - INFO - Training.
2022-02-15 18:48:26,514 - root - INFO - rec train loss:0.0000, kg train loss:0.0000!
2022-02-15 18:48:42,490 - root - INFO - f1:0.0018, p:0.0032, r:0.0016, hit:0.0303, ndcg:0.0167, topn:10.
2022-02-15 18:48:59,607 - root - INFO - f1:0.0025, p:0.0067, r:0.0021, hit:0.0621, ndcg:0.0337, topn:10.
2022-02-15 18:51:01,255 - root - INFO - head hit:0.0005, head mean rank:7023.7172, topn:10.
2022-02-15 18:51:01,256 - root - INFO - tail hit:0.0006, tail mean rank:7371.9444, topn:10.
2022-02-15 18:51:01,256 - root - INFO - avg hit:0.0006, avg mean rank:7197.8308, topn:10.
2022-02-15 18:53:48,818 - root - INFO - head hit:0.0007, head mean rank:7051.6945, topn:10.
2022-02-15 18:53:48,819 - root - INFO - tail hit:0.0008, tail mean rank:7371.7131, topn:10.
2022-02-15 18:53:48,820 - root - INFO - avg hit:0.0008, avg mean rank:7211.7038, topn:10.
2022-02-15 18:56:08,230 - root - INFO - rec train loss:46.3146, kg train loss:183.3568!
2022-02-15 18:56:25,576 - root - INFO - f1:0.0306, p:0.0475, r:0.0315, hit:0.3293, ndcg:0.1819, topn:10.
2022-02-15 18:56:42,309 - root - INFO - f1:0.0354, p:0.0817, r:0.0300, hit:0.4641, ndcg:0.2675, topn:10.
2022-02-15 18:58:39,199 - root - INFO - head hit:0.0011, head mean rank:5863.6821, topn:10.
2022-02-15 18:58:39,200 - root - INFO - tail hit:0.0698, tail mean rank:4789.3988, topn:10.
2022-02-15 18:58:39,200 - root - INFO - avg hit:0.0355, avg mean rank:5326.5405, topn:10.
2022-02-15 19:01:22,128 - root - INFO - head hit:0.0012, head mean rank:5896.7251, topn:10.
2022-02-15 19:01:22,129 - root - INFO - tail hit:0.0697, tail mean rank:4814.6344, topn:10.
2022-02-15 19:01:22,129 - root - INFO - avg hit:0.0354, avg mean rank:5355.6797, topn:10.
2022-02-15 19:01:22,177 - root - INFO - Checkpointing ...
2022-02-15 19:03:22,437 - root - INFO - rec train loss:41.1216, kg train loss:163.1557!
2022-02-15 19:03:38,729 - root - INFO - f1:0.0381, p:0.0611, r:0.0387, hit:0.3841, ndcg:0.2172, topn:10.
2022-02-15 19:03:55,397 - root - INFO - f1:0.0444, p:0.1024, r:0.0383, hit:0.5189, ndcg:0.3023, topn:10.
2022-02-15 19:05:51,956 - root - INFO - head hit:0.0022, head mean rank:5136.6155, topn:10.
2022-02-15 19:05:51,957 - root - INFO - tail hit:0.1380, tail mean rank:4288.6029, topn:10.
2022-02-15 19:05:51,957 - root - INFO - avg hit:0.0701, avg mean rank:4712.6092, topn:10.
2022-02-15 19:08:30,588 - root - INFO - head hit:0.0023, head mean rank:5168.8826, topn:10.
2022-02-15 19:08:30,589 - root - INFO - tail hit:0.1387, tail mean rank:4317.9547, topn:10.
2022-02-15 19:08:30,589 - root - INFO - avg hit:0.0705, avg mean rank:4743.4186, topn:10.
2022-02-15 19:08:30,638 - root - INFO - Checkpointing ...
2022-02-15 19:10:30,750 - root - INFO - rec train loss:38.6717, kg train loss:153.2181!
2022-02-15 19:10:47,147 - root - INFO - f1:0.0415, p:0.0667, r:0.0420, hit:0.4038, ndcg:0.2288, topn:10.
2022-02-15 19:11:04,516 - root - INFO - f1:0.0478, p:0.1106, r:0.0411, hit:0.5369, ndcg:0.3136, topn:10.
2022-02-15 19:12:58,408 - root - INFO - head hit:0.0041, head mean rank:4666.7431, topn:10.
2022-02-15 19:12:58,409 - root - INFO - tail hit:0.1661, tail mean rank:3992.4658, topn:10.
2022-02-15 19:12:58,409 - root - INFO - avg hit:0.0851, avg mean rank:4329.6044, topn:10.
2022-02-15 19:15:37,140 - root - INFO - head hit:0.0039, head mean rank:4696.5391, topn:10.
2022-02-15 19:15:37,141 - root - INFO - tail hit:0.1662, tail mean rank:4025.7099, topn:10.
2022-02-15 19:15:37,141 - root - INFO - avg hit:0.0850, avg mean rank:4361.1245, topn:10.
2022-02-15 19:15:37,192 - root - INFO - Checkpointing ...
2022-02-15 19:17:42,150 - root - INFO - rec train loss:37.0083, kg train loss:146.7363!
2022-02-15 19:17:59,667 - root - INFO - f1:0.0431, p:0.0694, r:0.0438, hit:0.4136, ndcg:0.2341, topn:10.
2022-02-15 19:18:16,164 - root - INFO - f1:0.0491, p:0.1136, r:0.0423, hit:0.5434, ndcg:0.3178, topn:10.
2022-02-15 19:20:08,058 - root - INFO - head hit:0.0060, head mean rank:4326.7459, topn:10.
2022-02-15 19:20:08,059 - root - INFO - tail hit:0.1789, tail mean rank:3788.7108, topn:10.
2022-02-15 19:20:08,059 - root - INFO - avg hit:0.0925, avg mean rank:4057.7283, topn:10.
2022-02-15 19:22:44,357 - root - INFO - head hit:0.0053, head mean rank:4354.4424, topn:10.
2022-02-15 19:22:44,358 - root - INFO - tail hit:0.1792, tail mean rank:3824.2422, topn:10.
2022-02-15 19:22:44,358 - root - INFO - avg hit:0.0923, avg mean rank:4089.3423, topn:10.
2022-02-15 19:22:44,410 - root - INFO - Checkpointing ...
2022-02-15 19:25:00,221 - root - INFO - rec train loss:35.7276, kg train loss:141.5623!
2022-02-15 19:25:17,723 - root - INFO - f1:0.0437, p:0.0707, r:0.0442, hit:0.4164, ndcg:0.2358, topn:10.
2022-02-15 19:25:34,277 - root - INFO - f1:0.0503, p:0.1163, r:0.0433, hit:0.5492, ndcg:0.3203, topn:10.
2022-02-15 19:27:26,315 - root - INFO - head hit:0.0082, head mean rank:4069.5703, topn:10.
2022-02-15 19:27:26,316 - root - INFO - tail hit:0.1853, tail mean rank:3638.8320, topn:10.
2022-02-15 19:27:26,317 - root - INFO - avg hit:0.0968, avg mean rank:3854.2011, topn:10.
2022-02-15 19:30:01,288 - root - INFO - head hit:0.0071, head mean rank:4095.0123, topn:10.
2022-02-15 19:30:01,289 - root - INFO - tail hit:0.1856, tail mean rank:3675.7843, topn:10.
2022-02-15 19:30:01,289 - root - INFO - avg hit:0.0963, avg mean rank:3885.3983, topn:10.
2022-02-15 19:30:01,339 - root - INFO - Checkpointing ...
2022-02-15 19:32:17,242 - root - INFO - rec train loss:34.7427, kg train loss:137.3922!
2022-02-15 19:32:34,151 - root - INFO - f1:0.0444, p:0.0715, r:0.0451, hit:0.4199, ndcg:0.2362, topn:10.
2022-02-15 19:32:51,959 - root - INFO - f1:0.0506, p:0.1174, r:0.0438, hit:0.5518, ndcg:0.3209, topn:10.
2022-02-15 19:34:44,408 - root - INFO - head hit:0.0101, head mean rank:3866.0479, topn:10.
2022-02-15 19:34:44,411 - root - INFO - tail hit:0.1892, tail mean rank:3521.1151, topn:10.
2022-02-15 19:34:44,411 - root - INFO - avg hit:0.0997, avg mean rank:3693.5815, topn:10.
2022-02-15 19:37:19,769 - root - INFO - head hit:0.0091, head mean rank:3889.0949, topn:10.
2022-02-15 19:37:19,770 - root - INFO - tail hit:0.1895, tail mean rank:3558.7453, topn:10.
2022-02-15 19:37:19,770 - root - INFO - avg hit:0.0993, avg mean rank:3723.9201, topn:10.
2022-02-15 19:37:19,818 - root - INFO - Checkpointing ...
2022-02-15 19:39:35,147 - root - INFO - rec train loss:33.9077, kg train loss:134.1203!
2022-02-15 19:39:51,909 - root - INFO - f1:0.0446, p:0.0720, r:0.0453, hit:0.4200, ndcg:0.2362, topn:10.
2022-02-15 19:40:09,992 - root - INFO - f1:0.0510, p:0.1183, r:0.0441, hit:0.5517, ndcg:0.3197, topn:10.
2022-02-15 19:42:02,028 - root - INFO - head hit:0.0117, head mean rank:3701.0675, topn:10.
2022-02-15 19:42:02,029 - root - INFO - tail hit:0.1917, tail mean rank:3425.5119, topn:10.
2022-02-15 19:42:02,029 - root - INFO - avg hit:0.1017, avg mean rank:3563.2897, topn:10.
2022-02-15 19:44:36,071 - root - INFO - head hit:0.0108, head mean rank:3721.9492, topn:10.
2022-02-15 19:44:36,072 - root - INFO - tail hit:0.1923, tail mean rank:3463.6106, topn:10.
2022-02-15 19:44:36,072 - root - INFO - avg hit:0.1016, avg mean rank:3592.7799, topn:10.
2022-02-15 19:44:36,123 - root - INFO - Checkpointing ...
2022-02-15 19:46:52,992 - root - INFO - rec train loss:33.0495, kg train loss:131.1196!
2022-02-15 19:47:10,075 - root - INFO - f1:0.0446, p:0.0722, r:0.0452, hit:0.4172, ndcg:0.2341, topn:10.
2022-02-15 19:47:27,103 - root - INFO - f1:0.0511, p:0.1187, r:0.0442, hit:0.5518, ndcg:0.3190, topn:10.
2022-02-15 19:49:18,613 - root - INFO - head hit:0.0132, head mean rank:3564.1083, topn:10.
2022-02-15 19:49:18,614 - root - INFO - tail hit:0.1938, tail mean rank:3345.3908, topn:10.
2022-02-15 19:49:18,614 - root - INFO - avg hit:0.1035, avg mean rank:3454.7495, topn:10.
2022-02-15 19:51:54,006 - root - INFO - head hit:0.0122, head mean rank:3582.7375, topn:10.
2022-02-15 19:51:54,007 - root - INFO - tail hit:0.1944, tail mean rank:3383.6904, topn:10.
2022-02-15 19:51:54,008 - root - INFO - avg hit:0.1033, avg mean rank:3483.2139, topn:10.
2022-02-15 19:51:54,061 - root - INFO - No improvement after one epoch. Lowering learning rate.
2022-02-15 19:54:10,944 - root - INFO - rec train loss:32.6978, kg train loss:129.6127!
2022-02-15 19:54:27,921 - root - INFO - f1:0.0464, p:0.0745, r:0.0473, hit:0.4275, ndcg:0.2345, topn:10.
2022-02-15 19:54:44,935 - root - INFO - f1:0.0524, p:0.1206, r:0.0458, hit:0.5555, ndcg:0.3180, topn:10.
2022-02-15 19:56:36,981 - root - INFO - head hit:0.0162, head mean rank:3356.2537, topn:10.
2022-02-15 19:56:36,982 - root - INFO - tail hit:0.1990, tail mean rank:3182.2648, topn:10.
2022-02-15 19:56:36,982 - root - INFO - avg hit:0.1076, avg mean rank:3269.2593, topn:10.
2022-02-15 19:59:10,589 - root - INFO - head hit:0.0152, head mean rank:3374.7018, topn:10.
2022-02-15 19:59:10,590 - root - INFO - tail hit:0.1996, tail mean rank:3216.4004, topn:10.
2022-02-15 19:59:10,590 - root - INFO - avg hit:0.1074, avg mean rank:3295.5511, topn:10.
2022-02-15 19:59:10,640 - root - INFO - Checkpointing ...
2022-02-15 20:01:20,776 - root - INFO - rec train loss:31.3861, kg train loss:124.2318!
2022-02-15 20:01:37,248 - root - INFO - f1:0.0457, p:0.0736, r:0.0467, hit:0.4220, ndcg:0.2314, topn:10.
2022-02-15 20:01:55,078 - root - INFO - f1:0.0519, p:0.1198, r:0.0452, hit:0.5490, ndcg:0.3123, topn:10.
2022-02-15 20:03:44,262 - root - INFO - head hit:0.0176, head mean rank:3199.9587, topn:10.
2022-02-15 20:03:44,263 - root - INFO - tail hit:0.2003, tail mean rank:3093.9178, topn:10.
2022-02-15 20:03:44,263 - root - INFO - avg hit:0.1089, avg mean rank:3146.9382, topn:10.
2022-02-15 20:06:15,063 - root - INFO - head hit:0.0165, head mean rank:3215.4761, topn:10.
2022-02-15 20:06:15,064 - root - INFO - tail hit:0.2008, tail mean rank:3127.7020, topn:10.
2022-02-15 20:06:15,064 - root - INFO - avg hit:0.1087, avg mean rank:3171.5890, topn:10.
2022-02-15 20:06:15,117 - root - INFO - No improvement after one epoch. Lowering learning rate.
2022-02-15 20:08:14,832 - root - INFO - rec train loss:31.0602, kg train loss:122.7359!
2022-02-15 20:08:32,386 - root - INFO - f1:0.0455, p:0.0730, r:0.0466, hit:0.4194, ndcg:0.2279, topn:10.
2022-02-15 20:08:49,417 - root - INFO - f1:0.0519, p:0.1192, r:0.0453, hit:0.5505, ndcg:0.3092, topn:10.
2022-02-15 20:10:38,735 - root - INFO - head hit:0.0183, head mean rank:3120.7323, topn:10.
2022-02-15 20:10:38,736 - root - INFO - tail hit:0.2012, tail mean rank:3029.9828, topn:10.
2022-02-15 20:10:38,736 - root - INFO - avg hit:0.1097, avg mean rank:3075.3576, topn:10.
2022-02-15 20:13:11,119 - root - INFO - head hit:0.0171, head mean rank:3133.7029, topn:10.
2022-02-15 20:13:11,120 - root - INFO - tail hit:0.2023, tail mean rank:3063.6231, topn:10.
2022-02-15 20:13:11,120 - root - INFO - avg hit:0.1097, avg mean rank:3098.6630, topn:10.
2022-02-15 20:13:11,177 - root - INFO - No improvement after one epoch. Lowering learning rate.
2022-02-15 20:15:27,155 - root - INFO - rec train loss:30.6161, kg train loss:121.6359!
2022-02-15 20:15:43,766 - root - INFO - f1:0.0452, p:0.0726, r:0.0463, hit:0.4174, ndcg:0.2257, topn:10.
2022-02-15 20:16:00,731 - root - INFO - f1:0.0516, p:0.1181, r:0.0454, hit:0.5485, ndcg:0.3072, topn:10.
2022-02-15 20:17:51,009 - root - INFO - head hit:0.0187, head mean rank:3082.5859, topn:10.
2022-02-15 20:17:51,010 - root - INFO - tail hit:0.2019, tail mean rank:2999.9805, topn:10.
2022-02-15 20:17:51,010 - root - INFO - avg hit:0.1103, avg mean rank:3041.2832, topn:10.
2022-02-15 20:20:23,098 - root - INFO - head hit:0.0175, head mean rank:3094.4942, topn:10.
2022-02-15 20:20:23,099 - root - INFO - tail hit:0.2027, tail mean rank:3032.9177, topn:10.
2022-02-15 20:20:23,099 - root - INFO - avg hit:0.1101, avg mean rank:3063.7060, topn:10.
2022-02-15 20:20:23,155 - root - INFO - No improvement after one epoch. Lowering learning rate.
2022-02-15 20:22:21,917 - root - INFO - rec train loss:30.5665, kg train loss:120.8328!
2022-02-15 20:22:38,549 - root - INFO - f1:0.0450, p:0.0723, r:0.0461, hit:0.4169, ndcg:0.2252, topn:10.
2022-02-15 20:22:57,056 - root - INFO - f1:0.0515, p:0.1179, r:0.0453, hit:0.5483, ndcg:0.3059, topn:10.
2022-02-15 20:24:45,928 - root - INFO - head hit:0.0191, head mean rank:3063.6187, topn:10.
2022-02-15 20:24:45,929 - root - INFO - tail hit:0.2021, tail mean rank:2985.2232, topn:10.
2022-02-15 20:24:45,929 - root - INFO - avg hit:0.1106, avg mean rank:3024.4210, topn:10.
2022-02-15 20:27:15,672 - root - INFO - head hit:0.0180, head mean rank:3075.6430, topn:10.
2022-02-15 20:27:15,673 - root - INFO - tail hit:0.2030, tail mean rank:3018.1116, topn:10.
2022-02-15 20:27:15,674 - root - INFO - avg hit:0.1105, avg mean rank:3046.8773, topn:10.
2022-02-15 20:27:15,722 - root - INFO - No improvement after one epoch. Lowering learning rate.
2022-02-15 20:29:15,494 - root - INFO - rec train loss:30.4560, kg train loss:120.5580!
2022-02-15 20:29:32,964 - root - INFO - f1:0.0450, p:0.0723, r:0.0460, hit:0.4169, ndcg:0.2255, topn:10.
2022-02-15 20:29:49,696 - root - INFO - f1:0.0515, p:0.1176, r:0.0454, hit:0.5493, ndcg:0.3064, topn:10.
2022-02-15 20:31:38,550 - root - INFO - head hit:0.0190, head mean rank:3054.3269, topn:10.
2022-02-15 20:31:38,551 - root - INFO - tail hit:0.2022, tail mean rank:2978.2142, topn:10.
2022-02-15 20:31:38,551 - root - INFO - avg hit:0.1106, avg mean rank:3016.2706, topn:10.
2022-02-15 20:34:11,001 - root - INFO - head hit:0.0181, head mean rank:3066.1820, topn:10.
2022-02-15 20:34:11,002 - root - INFO - tail hit:0.2030, tail mean rank:3010.8453, topn:10.
2022-02-15 20:34:11,002 - root - INFO - avg hit:0.1105, avg mean rank:3038.5136, topn:10.
2022-02-15 20:34:11,037 - root - INFO - No improvement after one epoch. Lowering learning rate.
2022-02-15 20:34:11,062 - root - INFO - No improvement after 70000 steps. Stopping training.
